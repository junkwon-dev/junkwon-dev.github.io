---
title:  "Dockerë¥¼ ì´ìš©í•œ ëŒ€ìš©ëŸ‰ ë©”ì‹œì§€ í RabbitMQ ì„¤ì¹˜ ë° ì‚¬ìš©ë°©ë²•"
excerpt: "ëŒ€ìš©ëŸ‰ ë©”ì‹œì§€ íë¥¼ ì‚¬ìš©í•œ ì´ìœ ì™€ ì„¤ì¹˜ ë° ì‚¬ìš©ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤."

categories:
  - Message Queue
tags:
  - RabbitMQ
  - Crawler
last_modified_at: 2020-07-24 19:36:00
toc: true
toc_sticky: true
---

### ê°œìš”

Software Maestro 11ê¸° ê³¼ì • ì¤‘ í¬ë¡¤ëŸ¬ë¥¼ ë©€í‹°í”„ë¡œì„¸ì‹±í•˜ê¸° ìœ„í•´ ëŒ€ìš©ëŸ‰ ë©”ì‹œì§€ íì¸ RabbitMQë¥¼ ì‚¬ìš©í•˜ëŠ” ê³¼ì •ì„ ì•Œì•„ë³¸ë‹¤.

### Why Message Queue?

í¬ë¡¤ëŸ¬ë¥¼ ì—¬ëŸ¬ê°œ ëŒë¦¬ëŠ” ê²ƒì„ ìƒê°í–ˆì„ ë•Œ ë‘ê°€ì§€ ì˜µì…˜ì´ ìˆì—ˆë‹¤. ì²«ì§¸ëŠ” ë©€í‹°ì“°ë ˆë“œë¥¼ ì´ìš©í•œ í¬ë¡¤ë§, ë‘˜ì§¸ëŠ” ë©”ì‹œì§€ íë¥¼ ì´ìš©í•˜ì—¬ í¬ë¡¤ëŸ¬ ìì²´ë¥¼ ì—¬ëŸ¬ê°œ ì¼œì„œ ì§„í–‰í•˜ëŠ” í¬ë¡¤ë§ì´ì˜€ë‹¤.

ë‘ë²ˆì§¸ ë°©ë²•ì„ ì„ íƒí–ˆëŠ”ë°, ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ì—¬ëŸ¬ ì»´í“¨í„°ì—ì„œ ë™ì‹œì— ëŒë¦´ ìˆ˜ ìˆë‹¤.(í¬ë¡¤ëŸ¬ê°€ ê·¸ë•Œ í•„ìš”í•œ ë§í¬ë¥¼ ë°›ì•„ê°€ê¸° ë•Œë¬¸ì—)
2. ì‹¤íŒ¨ì‹œ ë‹¤ì‹œ íì— ë„£ì„ ìˆ˜ ìˆë‹¤.
3. ë©”ì‹œì§€ íë¥¼ ì´ìš©í•´ë³´ê³  ì‹¶ì—ˆë‹¤.

ê·¸ë¦¬ê³  ë©€í‹°ì“°ë ˆë“œë¥¼ ì´ìš©í•œ ë¡œì§ êµ¬ìƒë³´ë‹¤ ë©”ì‹œì§€ íë¥¼ ì´ìš©í•œ í”„ë¡œê·¸ë¨ ë¡œì§ êµ¬ìƒì´ ì¢€ ë” ì˜ ë˜ì—ˆë‹¤.

### Why RabbitMQ?

RabbitMQë¥¼ ì‚¬ìš©í•œ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ê´€ë¦¬ UIê°€ ìˆì–´ í¸í•˜ê²Œ ê´€ë¦¬ ê°€ëŠ¥í•¨.
2. ëª¨ë“  ì–¸ì–´ì™€ ìš´ì˜ì²´ì œë¥¼ ì§€ì›í•¨.
3. ì˜¤í”ˆì†ŒìŠ¤ë¡œ ìƒì—…ì  ì§€ì›ì´ ê°€ëŠ¥í•¨.
4. pika ëª¨ë“ˆë¡œ ì½”ë“œ êµ¬ì„±ì´ ë¬´ì²™ ì‰¬ì›€.

ë¬´ì—‡ë³´ë‹¤ ë©”ì‹œì§€ íë¥¼ ì²˜ìŒ ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œ **ì‚¬ìš©í•˜ê¸° ê°„í¸**í–ˆë˜ ê²ƒì´ ê°€ì¥ í° ì´ìœ ì˜€ë‹¤.

### RabbitMQ ì„¤ì¹˜í•˜ê¸°

ì„œë²„ì— Docker imageë¡œ RabbitMQë¥¼ ì„¤ì¹˜í–ˆëŠ”ë°, ì •ë§ ë¬¼ê±´ì´ë‹¤.

```bash
$ docker run -d --hostname my-rabbit --name some-rabbit rabbitmq:3
```

ìœ„ì™€ ê°™ì€ ì½”ë“œ í•œì¤„ì´ë©´ ëª¨ë“  ì„¸íŒ…ì´ ëë‚œë‹¤.

ğŸ‘‰Docker ì‚¬ìš©ë²•ì„ ì•Œê³  ì‹¶ë‹¤ë©´? [ë„ì»¤ ì•ˆë‚´ì†Œ](https://junkwon-dev.github.io/blog/docker/) 

ë‚´ ê²½ìš°ì—” AWSë¥¼ ì´ìš©í–ˆê¸° ë•Œë¬¸ì— ë³´ì•ˆê·¸ë£¹ì—ì„œ í¬íŠ¸ë¥¼ ì—´ì–´ì£¼ì–´ì•¼ í•œë‹¤. rabbitmq default í¬íŠ¸ëŠ” 30000ì´ë‹¤.

### RabbitMQ Hello world

RabbitMQì—ì„œ ê³µì‹ì ìœ¼ë¡œ ì§€ì›í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” Pikaì´ë‹¤. ë‹¤ìŒì€ ê³µì‹ ë¬¸ì„œì˜ send.pyì´ë‹¤.

```python
#!/usr/bin/env python
import pika

connection = pika.BlockingConnection(
    pika.ConnectionParameters(host='localhost'))
channel = connection.channel()

channel.queue_declare(queue='hello')

channel.basic_publish(exchange='', routing_key='hello', body='Hello World!')
print(" [x] Sent 'Hello World!'")
connection.close()
```

ë‹¤ìŒì€ ê³µì‹ ë¬¸ì„œì˜ receive.pyì´ë‹¤.

```python
#!/usr/bin/env python
import pika

connection = pika.BlockingConnection(
    pika.ConnectionParameters(host='localhost'))
channel = connection.channel()

channel.queue_declare(queue='hello')


def callback(ch, method, properties, body):
    print(" [x] Received %r" % body)


channel.basic_consume(
    queue='hello', on_message_callback=callback, auto_ack=True)

print(' [*] Waiting for messages. To exit press CTRL+C')
channel.start_consuming()
```

ë‹¤ìŒì—” í¬ë¡¤ëŸ¬ë¥¼ ì—¬ëŸ¬ê°œ ì‹¤í–‰ì‹œì¼œì¤„ supervisorì„ ì•Œì•„ë³´ì.

 